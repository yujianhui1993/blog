{"title":"h5页面调用摄像头","uid":"e2dd80b7de5fb2e3b8f29ae72f511dd3","slug":"h5medio","date":"2023-01-01T10:49:36.000Z","updated":"2023-06-14T01:59:39.029Z","comments":false,"path":"api/articles/h5medio.json","keywords":null,"cover":null,"content":"<h1 id=\"h5页面调用摄像头\"><a href=\"#h5页面调用摄像头\" class=\"headerlink\" title=\"h5页面调用摄像头\"></a>h5页面调用摄像头</h1><h2 id=\"调用摄像头的几个易难点\"><a href=\"#调用摄像头的几个易难点\" class=\"headerlink\" title=\"调用摄像头的几个易难点\"></a>调用摄像头的几个易难点</h2><ol>\n<li>本地可以部署后不行<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p> navigator.mediaDevices 调用需要在 localhost,或者https 的环境下才能成功，如果是http的则将报错，无法调用成功。</p></blockquote>\n</li>\n<li>video 的宽高设置<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>video组件的宽高比是固定的，直接设置宽高是不能达到效果，我们需要 “object-fit: fill”, 将内容填充。这样设置的宽高才有效果。</p></blockquote>\n</li>\n<li>video 呈现的画面镜像问题<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这个需要翻转 利用 transform: rotateY(180deg)可以实现。</p></blockquote>\n</li>\n<li>ios 无法调用问题<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>网上原有的方案中。在video.onloadedmetadata 方法中去调用 video.play() 可实现调起摄像头（在安卓手机上）。ios在升级后，这种方案已经无法调用了。我们需要调用 video.load() 后，延迟调用video.play() 延迟时间大概一秒左右。（底部有源码）</p></blockquote>\n</li>\n<li>保存图片镜像问题<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>利用canvas 保存video帧动画时，也会出现图片镜像问题，这时我们需要 context.scale(-1, 1) 左右镜像翻转，来实现。</p></blockquote>\n</li>\n</ol>\n<h2 id=\"vue-封装的-h5中调用摄像头代码-使用方法\"><a href=\"#vue-封装的-h5中调用摄像头代码-使用方法\" class=\"headerlink\" title=\"vue 封装的 h5中调用摄像头代码 使用方法\"></a>vue 封装的 h5中调用摄像头代码 使用方法</h2><ol>\n<li><p>引入组件（下方代码）</p>\n</li>\n<li><p>暴露方法 getVideoCameraInfo() 返回 canvas的数据，由自己处理</p>\n</li>\n</ol>\n<h3 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h3><details class=\"custom-details\">\n<summary>点击查看内容</summary>\n<p><pre><code class=\"vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;video\n      ref=&quot;video&quot;\n      id=&quot;videoCamera&quot;\n      autoPlay\n      muted\n      :width=&quot;videoWidth&quot;\n      :height=&quot;videoHeight&quot;\n      playsInline&gt;\n    &lt;/video&gt;\n    &lt;canvas \n      style=&quot;display: none&quot;\n      :width=&quot;videoWidth&quot;\n      :height=&quot;videoHeight&quot;\n      id=&quot;canvasCamera&quot;&gt;\n    &lt;/canvas&gt;\n    &lt;div class=&quot;video-mark&quot;&gt;\n      &lt;!--&gt;插槽可自定义自己的遮罩层 &lt;!--&gt;\n      &lt;slot name=&quot;mark&quot;&gt;&lt;/slot&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nimport &#123; Toast &#125; from &#39;vant&#39;;\n\nexport default &#123;\n  props: &#123;\n    // 设置video 的宽\n    videoWidth: &#123;\n      type: [ Number, String],\n      default: 300\n    &#125;,\n    // 设置video 的高\n    videoHeight: &#123;\n      type: [ Number, String],\n      default: 300\n    &#125;\n  &#125;,\n\n  mounted() &#123;\n    // 进入页面 自动调用摄像头\n    this.initCamera();\n  &#125;,\n\n  methods: &#123;\n    async initCamera() &#123;\n      // 提示\n      await this.initToast(&#39;初始化...&#39;, 0)\n      // 校验兼容性\n      await this.checkCompatible()\n      // 创建video\n      await this.createVideo()\n\n    &#125;,\n\n    // 生成video\n    async createVideo() &#123;\n      const constraints = &#123;\n        audio: false,\n        video: &#123;\n          width: this.videoWidth,\n          height: this.videoHeight,\n          facingMode: &quot;user&quot; // 前置优先\n        &#125;\n      &#125;;\n      // 正常支持版本\n      navigator.mediaDevices.getUserMedia(constraints).then((stream) =&gt; &#123;\n        // 摄像头开启成功\n        this.$refs.video.srcObject = stream;\n        // ios 需要video load后才可以调用play\n        // 调用play 需要延迟处理\n        this.$refs.video.load()\n        setTimeout(() =&gt; &#123;\n          this.$refs.video.play()\n          Toast.clear();\n        &#125;, 1000);\n      &#125;).catch(err =&gt; &#123;\n        Toast.clear();\n        console.log(&#39;error===&gt;&#39;, err);\n      &#125;);\n    &#125;,\n\n    // 校验兼容性\n    async checkCompatible() &#123;\n      // 兼容性判断\n      // 旧版本浏览器可能根本不支持mediaDevices,首先设置一个空对象\n      if (navigator.mediaCapabilities === undefined) &#123;\n        navigator.mediaCapabilities = &#123;&#125;;\n      &#125;\n      // 一些浏览器实现了部分mediaDevices,不能值分配一个对象\n      // 使用getUserMedia属性，就添加她\n      if (navigator.mediaDevices.getUserMedia === undefined) &#123;\n        // eslint-disable-next-line func-names\n        navigator.mediaCapabilities.getUserMedia = function(constraints) &#123;\n          // 首先获取现存的getUserMedia(如果存在)\n          const getUserMedia =\n            navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.getUserMedia;\n          // 有些浏览器不支持，会返回错误信息\n          // 保持接口一致\n          if (!getUserMedia) &#123;\n            return Promise.reject(new Error(&quot;浏览器不支持！&quot;));\n          &#125;\n          // 否则，使用Promise将调用爆炸到旧的navigator.getUserMedia\n          return new Promise((resolve, reject) =&gt; &#123;\n            getUserMedia.call(navigator, constraints, resolve, reject);\n          &#125;);\n        &#125;;\n      &#125;\n    &#125;,\n\n    // 获取\n    getVideoCameraInfo() &#123;\n      // 获取 canvas 画布\n      const canvas = document.getElementById(&#39;canvasCamera&#39;);\n      const context = canvas.getContext(&#39;2d&#39;);\n\n      // 位移来做镜像翻转\n      context.translate(this.videoWidth, 0);\n      context.scale(-1, 1); // 左右镜像翻转\n      context.drawImage(this.$refs.video, 0, 0,  this.videoWidth, this.videoHeight);\n      return canvas;\n      // const image = canvas.toDataURL(&#39;image/png&#39;);\n      // return image;\n    &#125;,\n\n    async initToast(msg, duration = 0) &#123;\n      Toast.loading(&#123;\n        duration, // 持续展示 toast\n        forbidClick: true,\n        message: msg,\n      &#125;);\n    &#125;\n  &#125;,\n\n  beforeDestroy() &#123;\n    // 关闭视频\n    this.$refs.video.srcObject.getTracks()[0].stop();\n  &#125;\n&#125;\n&lt;/script&gt;\n\n&lt;style lang=&quot;scss&quot; scoped&gt;\n.video-mark &#123;\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n&#125;\n\nvideo &#123;\n  display: block;\n  object-fit: fill;\n  transform: rotateY(180deg);\n  -webkit-transform: rotateY(180deg);    /* Safari 和 Chrome */\n  -moz-transform: rotateY(180deg);\n&#125;\n&lt;/style&gt;\n</code></pre>\n</p>\n</details>\n<h2 id=\"附上压缩文件方法\"><a href=\"#附上压缩文件方法\" class=\"headerlink\" title=\"附上压缩文件方法\"></a>附上压缩文件方法</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>引入 npm run browser-image-compression</p></blockquote>\n<h3 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>import imageCompression from ‘browser-image-compression’</p></blockquote>\n<pre><code class=\"vue\">  // 获取图片base64链接\n  const options = &#123;\n    maxSizeMB: 0.05, //压缩大小 MB\n    maxWidthOrHeight: 200, // 压缩尺寸\n    useWebWorker: true,\n    fileType: &#39;image/jpeg&#39; // 文件类型\n  &#125;\n\n const compressedFile = await imageCompression(blob, options);\n</code></pre>\n","text":"h5页面调用摄像头调用摄像头的几个易难点 本地可以部署后不行 navigator.mediaDevices 调用需要在 localhost,或者https 的环境下才能成功，如果是http的则将报错，无法调用成功。 video 的宽高设置 video组件的宽高比是固定的，直接设置...","link":"","photos":[],"count_time":{"symbolsCount":"5.3k","symbolsTime":"5 mins."},"categories":[{"name":"文章","slug":"文章","count":3,"path":"api/categories/文章.json"}],"tags":[{"name":"技术分享","slug":"技术分享","count":3,"path":"api/tags/技术分享.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#h5%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4\"><span class=\"toc-text\">h5页面调用摄像头</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%B0%83%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E7%9A%84%E5%87%A0%E4%B8%AA%E6%98%93%E9%9A%BE%E7%82%B9\"><span class=\"toc-text\">调用摄像头的几个易难点</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#vue-%E5%B0%81%E8%A3%85%E7%9A%84-h5%E4%B8%AD%E8%B0%83%E7%94%A8%E6%91%84%E5%83%8F%E5%A4%B4%E4%BB%A3%E7%A0%81-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">vue 封装的 h5中调用摄像头代码 使用方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">代码</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%99%84%E4%B8%8A%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">附上压缩文件方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">使用方法</span></a></li></ol></li></ol></li></ol>","author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"vue项目基于openvvjs实现的人脸识别","uid":"db37ea6f31232dd74a3dded1a54df39b","slug":"face-check","date":"2023-05-10T02:00:00.000Z","updated":"2023-06-15T01:55:27.116Z","comments":false,"path":"api/articles/face-check.json","keywords":null,"cover":"/blog/post/face-check/face-cover.png","text":"vue项目基于openvvjs实现的人脸识别 之所以研究这个，是有一个项目中需要对上传的图片进行人脸验证，之前也有一个方案是video中增加实时人脸检测，但是优化的效果和体验不是很好。所以放弃了。对于图片的检测那就相对来说简单了好多。其中也有很多第三方的api也支持识别。那为什么...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"文章","slug":"文章","count":3,"path":"api/categories/文章.json"}],"tags":[{"name":"技术分享","slug":"技术分享","count":3,"path":"api/tags/技术分享.json"}],"author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"css 规范","uid":"c296943c65b43b76bdcdb70695a515ae","slug":"css-standard","date":"2022-10-15T10:49:36.000Z","updated":"2023-06-14T01:32:54.442Z","comments":false,"path":"api/articles/css-standard.json","keywords":null,"cover":"../../../images/tu01.png","text":"css 规范css 规范文档 命名 样式类名使用小写字母，以半角连接符(-)分割； id 采用驼峰式命名； scss &#x2F; less 中的变量、函数、混合、placeholder 采用驼峰式命名 不推荐： .fw-800 &#123; font-weight: 800; ...","link":"","photos":[],"count_time":{"symbolsCount":"4.2k","symbolsTime":"4 mins."},"categories":[{"name":"规范","slug":"规范","count":4,"path":"api/categories/规范.json"}],"tags":[{"name":"css规范","slug":"css规范","count":1,"path":"api/tags/css规范.json"}],"author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}