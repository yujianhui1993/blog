{"title":"zimg图片服务器搭建","uid":"e50ba6803b4df95461e9909eca184678","slug":"zimg","date":"2022-02-01T10:49:36.000Z","updated":"2023-06-15T06:06:45.127Z","comments":false,"path":"api/articles/zimg.json","keywords":null,"cover":"/blog/post/zimg/zimg-cover.jpg","content":"<h2 id=\"zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。\"><a href=\"#zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。\" class=\"headerlink\" title=\"zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。\"></a>zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。</h2><p><a href=\"http://zimg.buaa.us/\">官网地址：</a></p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h3><pre><code class=\"shell\">\n  sudo yum install openssl-devel cmake libevent-devel libjpeg-devel giflib-devel \n  libpng-devel libwebp-devel ImageMagick-devel libmemcached-develel ImageMagick-devel libmemcached-devel\n</code></pre>\n<h3 id=\"也可以通过源代码构建依赖关系\"><a href=\"#也可以通过源代码构建依赖关系\" class=\"headerlink\" title=\"也可以通过源代码构建依赖关系\"></a>也可以通过源代码构建依赖关系</h3><h4 id=\"1-openssl-安装\"><a href=\"#1-openssl-安装\" class=\"headerlink\" title=\"1. openssl 安装\"></a>1. openssl 安装</h4><pre><code class=\"shell\">\n  wget http://www.openssl.org/source/openssl-1.0.1i.tar.gz\n  tar zxvf openssl-1.0.1i.tar.gz\n  cd openssl-1.0.1i\n  ./config shared --prefix=/usr/local --openssldir=/usr/ssl\n  make &amp;&amp; make install \n</code></pre>\n<h4 id=\"2-cmake-安装\"><a href=\"#2-cmake-安装\" class=\"headerlink\" title=\"2. cmake 安装\"></a>2. cmake 安装</h4><pre><code class=\"shell\">\n  wget http://www.cmake.org/files/v3.0/cmake-3.0.1.tar.gz\n  tar xzvf cmake-3.0.1.tar.gz \n  cd cmake-3.0.1\n  ./bootstrap --prefix=/usr/local \n  make &amp;&amp; make install \n</code></pre>\n<h4 id=\"3-libevent-安装\"><a href=\"#3-libevent-安装\" class=\"headerlink\" title=\"3. libevent 安装\"></a>3. libevent 安装</h4><pre><code class=\"shell\">\n  wget http://cloud.github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz\n  tar zxvf libevent-2.0.21-stable.tar.gz\n  cd libevent-2.0.21-stable\n  ./configure --prefix=/usr/local \n  make &amp;&amp; make install \n</code></pre>\n<h4 id=\"4-libjpeg-turbo\"><a href=\"#4-libjpeg-turbo\" class=\"headerlink\" title=\"4. libjpeg-turbo\"></a>4. libjpeg-turbo</h4><pre><code class=\"shell\">\n  wget https://downloads.sourceforge.net/project/libjpeg-turbo/1.3.1/libjpeg-turbo-1.3.1.tar.gz\n  tar zxvf libjpeg-turbo-1.3.1.tar.gz\n  cd libjpeg-turbo-1.3.1\n  ./configure --prefix=/usr/local --with-jpeg8\n  make &amp;&amp; make install\n</code></pre>\n<h5 id=\"4-1-要构建libjpeg-turbo，必须先安装nasm。\"><a href=\"#4-1-要构建libjpeg-turbo，必须先安装nasm。\" class=\"headerlink\" title=\"4.1 要构建libjpeg-turbo，必须先安装nasm。\"></a>4.1 要构建libjpeg-turbo，必须先安装nasm。</h5><pre><code class=\"shell\">\n  wget https://www.nasm.us/pub/nasm/releasebuilds/2.14rc16/nasm-2.14rc16.tar.gz\n  tar zxvf nasm-2.10.07.tar.gz\n  cd nasm-2.10.07\n  ./configure\n  make\n  sudo make install\n</code></pre>\n<h4 id=\"5-构建zimg本身\"><a href=\"#5-构建zimg本身\" class=\"headerlink\" title=\"5. 构建zimg本身\"></a>5. 构建zimg本身</h4><pre><code class=\"shell\">\n  git clone https://github.com/buaazp/zimg -b master --depth=1\n  cd zimg   \n  make\n</code></pre>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>安装过程可能会失败，我在安装的时候就有一个 libjpeg-turbo 安装失败。</p></blockquote>\n<h4 id=\"6-运行zimg\"><a href=\"#6-运行zimg\" class=\"headerlink\" title=\"6. 运行zimg\"></a>6. 运行zimg</h4><pre><code class=\"shell\">\n  cd bin  \n  ./zimg conf/zimg.lua\n</code></pre>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>需要调整配置，可以修改zimg.lua的文件，里面有详细的注释。</p></blockquote>\n<h4 id=\"运行成功页面\"><a href=\"#运行成功页面\" class=\"headerlink\" title=\"运行成功页面\"></a>运行成功页面</h4><p><img src=\"./zimg/zimg-success.png\" alt=\"效果图\"></p>\n","text":"zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。官网地址： 安装安装依赖 sudo yum install openssl-devel cmake libevent-devel libjpeg-devel giflib-devel libpng...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":5,"path":"api/categories/文章.json"}],"tags":[{"name":"技术分享","slug":"技术分享","count":5,"path":"api/tags/技术分享.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#zimg%E6%98%AF%E5%9B%BE%E5%83%8F%E5%AD%98%E5%82%A8%E5%92%8C%E5%A4%84%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%82%E6%82%A8%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8URL%E5%8F%82%E6%95%B0%E4%BB%8Ezimg%E8%8E%B7%E5%8F%96%E5%8E%8B%E7%BC%A9%E5%92%8C%E7%BC%A9%E6%94%BE%E7%9A%84%E5%9B%BE%E5%83%8F%E3%80%82\"><span class=\"toc-text\">zimg是图像存储和处理服务器。您可以使用URL参数从zimg获取压缩和缩放的图像。</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">安装依赖</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B9%9F%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E6%BA%90%E4%BB%A3%E7%A0%81%E6%9E%84%E5%BB%BA%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB\"><span class=\"toc-text\">也可以通过源代码构建依赖关系</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-openssl-%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">1. openssl 安装</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-cmake-%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">2. cmake 安装</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-libevent-%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">3. libevent 安装</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-libjpeg-turbo\"><span class=\"toc-text\">4. libjpeg-turbo</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-1-%E8%A6%81%E6%9E%84%E5%BB%BAlibjpeg-turbo%EF%BC%8C%E5%BF%85%E9%A1%BB%E5%85%88%E5%AE%89%E8%A3%85nasm%E3%80%82\"><span class=\"toc-text\">4.1 要构建libjpeg-turbo，必须先安装nasm。</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5-%E6%9E%84%E5%BB%BAzimg%E6%9C%AC%E8%BA%AB\"><span class=\"toc-text\">5. 构建zimg本身</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6-%E8%BF%90%E8%A1%8Czimg\"><span class=\"toc-text\">6. 运行zimg</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%BF%90%E8%A1%8C%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2\"><span class=\"toc-text\">运行成功页面</span></a></li></ol></li></ol></li></ol>","author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"h5页面调用摄像头","uid":"e2dd80b7de5fb2e3b8f29ae72f511dd3","slug":"h5medio","date":"2023-01-01T10:49:36.000Z","updated":"2023-06-15T06:12:34.775Z","comments":false,"path":"api/articles/h5medio.json","keywords":null,"cover":"/blog/post/h5medio/h5-cover.jpeg","text":"h5页面调用摄像头调用摄像头的几个易难点 本地可以部署后不行 navigator.mediaDevices 调用需要在 localhost,或者https 的环境下才能成功，如果是http的则将报错，无法调用成功。 video 的宽高设置 video组件的宽高比是固定的，直接设置...","link":"","photos":[],"count_time":{"symbolsCount":"5.3k","symbolsTime":"5 mins."},"categories":[{"name":"文章","slug":"文章","count":5,"path":"api/categories/文章.json"}],"tags":[{"name":"技术分享","slug":"技术分享","count":5,"path":"api/tags/技术分享.json"}],"author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"实现三角角标的方式","uid":"e0c6a5204d334ae8764cdaed8e43fc78","slug":"triangle-subscript","date":"2022-01-01T10:49:36.000Z","updated":"2023-06-15T05:36:25.231Z","comments":false,"path":"api/articles/triangle-subscript.json","keywords":null,"cover":"/blog/post/triangle-subscript/sjjb.webp","text":"方式一 直接使用三角角标图片，通过定位的方式，定位到对应的位置 方式2 使用正方形方块，旋转45度角transform: rotate(45deg);，通过定位到对应位置。其中对于父元素，我们需要使用 overflow: hidden;不然方块显示会操出父元素。 方式3 利用线性...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"文章","slug":"文章","count":5,"path":"api/categories/文章.json"}],"tags":[{"name":"技术分享","slug":"技术分享","count":5,"path":"api/tags/技术分享.json"}],"author":{"name":"虞建辉","slug":"虞建辉","avatar":"https://avatars.githubusercontent.com/u/7228360?s=400&u=5b2242e59ba02c0e1e7bc43eb68b070e26ec6a6e&v=4","link":"/","description":"好的程序员从来不只写代码，他们还致力于优雅地解决问题","socials":{"github":"https://github.com/yujianhui1993?tab=repositories","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}